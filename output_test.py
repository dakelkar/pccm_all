import sqlite3
from xlsxwriter.workbook import Workbook
import pccm_names
workbook = Workbook('output_test_280202018.xlsx')
worksheet = workbook.add_worksheet()
#conn=sqlite3.connect('DB\\PCCM_BreastCancerDB11_2018-02-22.db')
#cursor=conn.cursor()
#cursor.execute("select * from Patient_Information_History")

mysel=cursor.execute("select * from Patient_Information_History")
row = mysel.fetchone()
names = row.keys()
for i, row in enumerate(mysel):
    for j, value in enumerate(row):
        worksheet.write_row(i, 0, row)
workbook.close()

x = cursor.execute("SELECT sql FROM sqlite_master WHERE tbl_name = 'Patient_Information_History' AND type = 'table'")
col_name = x.fetchall()

[('CREATE TABLE Patient_Information_History (File_number, MR_number, Name, Consent, Aadhaar_Card, FirstVisit_Date, Permanent_Address, Current_Address, Phone, Email_ID, Gender, Age_yrs, Date_of_Birth, Place_Birth, Height_cm, Weight_kg, BMI, Diet, Alcohol_y_n, Alcohol_Consumption_age_yrs, Quantity_alcohol_per_week, Duration_alcohol, Comments_alcohol, Tobacco_y_n, Type_tobacco, Tobacco_consumption_age_yrs, Quantity_tobacco_per_week, Duration_tobacco, Comments_tobacco, Other_Deleterious_Habits, Nutritional_supplements_y_n, Type_Nutritional_supplements, Quantity_Nutritional_supplements, Duration_Nutritional_supplements, Physical_Activity_y_n, Type_Physical_Activity, Frequency_Physical_Activity, Any_Other_Medical_History_y_n, Type_Any_Other_Medical_History, Diagnosis_Date_Any_Other_Medical_History, Treatment_Any_Other_Medical_History, Previous_Cancer_History_y_n, Type_Previous_Cancer, Year_Diagnosed_Previous_Cancer, Treatment_Previous_Cancer, Treatment_Type_Previous_Cancer, Treatment_Duration_Previous_Cancer, FamilyCancer_history_y_n, Type_DegreeRelation_TypeRelation_Age_FamilyCancer, Marital_Status, Siblings, Sisters, Brothers, Children, Daughters, Sons, Menarche_yrs, Menopause_Status, Age_at_Menopause_yrs, Date_last_menstrual_period, Period_Type, Number_pregnancies, Pregnancy_to_term, Number_abortions, Age_first_child, Age_first_pregnancy, Age_last_child, Age_last_pregnancy, Two_births_in_year, Breast_feeding, Child_Breast_feeding, Duration_Breast_feeding, Breast_Usage_Breast_feeding, Type_birth_control_used, Details_birth_control, Duration_birth_control, Current_Breast_Cancer_Detected_By, Current_Breast_Cancer_Detected_Date, RB_symptoms, RB_symptoms_duration, LB_symptoms, LB_symptoms_duration, RB_Other_Symptoms, RB_Other_Symptoms_duration, LB_Other_Symptoms, LB_Other_Symptoms_duration, Metatasis_Symptoms, Provisional_Diagnosis_Clinical_Examination_CE, Lump_Palpable_CE, Lump_Location_CE, Lump_Size_CE, Lump_Number_CE, Lump_Consistency_CE, Lump_Fixity_CE, Mastitis_CE, Mastitis_type_CE, Tenderness_CE, Nipple_Retraction_CE, Nipple_Discharge_CE, Nipple_Discharge_Type_CE, Skin_changes_CE, Skin_change_type_CE, Palpable_axillary_nodes_CE, Palpable_axillary_nodes_number_CE, Palpable_axillary_nodes_size_CE, Palpable_axillary_nodes_fixity_CE, Palpable_supraclavicular_nodes_CE, Palpable_supraclavicular_nodes_number_CE, Palpable_supraclavicular_nodes_size_CE, Palpable_supraclavicular_nodes_fixity_CE, Contralateral_Breast_CE, Edema_arm_CE, RightArm_Circumference_cm_CE, RightArm_UpperLimbVolume_cc_CE, RightArm_ElbowDistance_cm_CE, LeftArm_Circumference_cm_CE, LeftArm_UpperLimbVolume_cc_CE, LeftArm_ElbowDistance_cm_CE, Nipple_Cytology, Date_Nipple_Cytology, Number_Nipple_Cytology, Report_Nipple_Cytology, DiagnosisLocation_Mammography, First_Mammography, LatestDate_Mammography, Number_Mammography, PreviousDate_Mammography, Diagnosis_Mammography, Date_Diagnosis_Mammography, AccessionNumber_Mammography, Lesion_Mammography, LesionLocation_Mammography, Shape_Mammography, Size_Mammography, Margin_Mammography, Density_Mammography, Calcification_Mammography, Calcification_Implication_Mammography, Calcification_Distribution_Mammography, Architecture_Mammography, Asymmetry_Mammography, IntraMammaryLN_Mammography, SkinLesion_Mammography, DilatedDuct_Mammography, Features_SkinRetraction_Mammography, Features_NippleRetraction_Mammography, Features_SkinThickening_Mammography, Features_TrabecularThickening_Mammography, Features_AxillaryLymphadenopathy_Mammography, SecondaryLesion_ContralateralBreast_Mammography, DistancefromSkin_Mammography, DistanceFromPectMaj_Mammography, BIRADS_Mammography, Tomosynthesis, Date_Tomosynthesis, Accession_Tomosynthesis, Lesion_Tomosynthesis, Size_Tomosynthesis, Distance_Tomosynthesis, Distance_PectMajor_Tomosynthesis, Diagnosis_Tomosynthesis, Block_SR_Number, Biopsy_Block_ID, No_of_blocks, Date_of_Biopsy, Lab_ID, Biopsy_Type, Tumour_biopsy_diagnosis, Tumour_biopsy_diagnosis_grade, Tumour_biopsy_ER, Tumour_biopsy_ER_Percent, Tumour_biopsy_PR, Tumour_biopsy_PR_Percent, Tumour_biopsy_HER2, Tumour_biopsy_HER2_Grade, Tumour_biopsy_FISH, Tumour_biopsy_Ki67_Percent, Lymph_Node_biopsy_FNAC, Lymph_Node_biopsy_location, Lymph_Node_biopsy_diagnosis, Surgical_Block_ID, Surgery_No_of_blocks, Block_Source, Tumor_block_ref, Nodes_block_ref, Ad_Normal_block_ref, Reduction_tissue_block_ref, Date_of_Surgery, Name_Surgeon, Hospital_ID, Lesion_Side, Type_surgery, Response_surgery, Tumour_size_Surgery_Block_Report, Grade_Surgery_Block_Report, Diagnosis_Surgery_Block_Report, DCIS_Percent_Surgery_Block_Report, DCIS_Invasion_Surgery_Block_Report, Perineural_Invasion_Surgery_Block_Report, Necrosis_Surgery_Block_Report, Lymphovascular_Invasion_Surgery_Block_Report, Margins_Surgery_Block_Report, Surgery_Block_Report, Sentinel_Node_Block_Report, Sentinel_Node_Number_Removed, Sentinel_Node_Number_Positive, Sentinel_Node_Block_Report_Number, Axillary_Node_Block_Report, Axillary_Node_Number_Removed, Axillary_Node_Number_Positive, Axillary_Node_Block_Report_Number, Apical_Node_Block_Report, Apical_Node_Number_Removed, Apical_Node_Number_Positive, Apical_Node_Block_Report_Number, Perinodal_Spread_Node_Block_Report, Supraclavicular_Involved_Node_Block_Report, Pathological_Staging_pT, Pathological_Staging_pN, Pathological_Staging_M, Pathological_Staging_P_Stage, Clinical_Staging)',)]
File_number, MR_number, Name, Consent, Aadhaar_Card, FirstVisit_Date, Permanent_Address, Current_Address, Phone, Email_ID, Gender, Age_yrs, Date_of_Birth, Place_Birth, Height_cm, Weight_kg, BMI, Diet, Alcohol_y_n, Alcohol_Consumption_age_yrs, Quantity_alcohol_per_week, Duration_alcohol, Comments_alcohol, Tobacco_y_n, Type_tobacco, Tobacco_consumption_age_yrs, Quantity_tobacco_per_week, Duration_tobacco, Comments_tobacco, Other_Deleterious_Habits, Nutritional_supplements_y_n, Type_Nutritional_supplements, Quantity_Nutritional_supplements, Duration_Nutritional_supplements, Physical_Activity_y_n, Type_Physical_Activity, Frequency_Physical_Activity, Any_Other_Medical_History_y_n, Type_Any_Other_Medical_History, Diagnosis_Date_Any_Other_Medical_History, Treatment_Any_Other_Medical_History, Previous_Cancer_History_y_n, Type_Previous_Cancer, Year_Diagnosed_Previous_Cancer, Treatment_Previous_Cancer, Treatment_Type_Previous_Cancer, Treatment_Duration_Previous_Cancer, FamilyCancer_history_y_n, Type_DegreeRelation_TypeRelation_Age_FamilyCancer, Marital_Status, Siblings, Sisters, Brothers, Children, Daughters, Sons, Menarche_yrs, Menopause_Status, Age_at_Menopause_yrs, Date_last_menstrual_period, Period_Type, Number_pregnancies, Pregnancy_to_term, Number_abortions, Age_first_child, Age_first_pregnancy, Age_last_child, Age_last_pregnancy, Two_births_in_year, Breast_feeding, Child_Breast_feeding, Duration_Breast_feeding, Breast_Usage_Breast_feeding, Type_birth_control_used, Details_birth_control, Duration_birth_control, Current_Breast_Cancer_Detected_By, Current_Breast_Cancer_Detected_Date, RB_symptoms, RB_symptoms_duration, LB_symptoms, LB_symptoms_duration, RB_Other_Symptoms, RB_Other_Symptoms_duration, LB_Other_Symptoms, LB_Other_Symptoms_duration, Metatasis_Symptoms, Provisional_Diagnosis_Clinical_Examination_CE, Lump_Palpable_CE, Lump_Location_CE, Lump_Size_CE, Lump_Number_CE, Lump_Consistency_CE, Lump_Fixity_CE, Mastitis_CE, Mastitis_type_CE, Tenderness_CE, Nipple_Retraction_CE, Nipple_Discharge_CE, Nipple_Discharge_Type_CE, Skin_changes_CE, Skin_change_type_CE, Palpable_axillary_nodes_CE, Palpable_axillary_nodes_number_CE, Palpable_axillary_nodes_size_CE, Palpable_axillary_nodes_fixity_CE, Palpable_supraclavicular_nodes_CE, Palpable_supraclavicular_nodes_number_CE, Palpable_supraclavicular_nodes_size_CE, Palpable_supraclavicular_nodes_fixity_CE, Contralateral_Breast_CE, Edema_arm_CE, RightArm_Circumference_cm_CE, RightArm_UpperLimbVolume_cc_CE, RightArm_ElbowDistance_cm_CE, LeftArm_Circumference_cm_CE, LeftArm_UpperLimbVolume_cc_CE, LeftArm_ElbowDistance_cm_CE, Nipple_Cytology, Date_Nipple_Cytology, Number_Nipple_Cytology, Report_Nipple_Cytology, DiagnosisLocation_Mammography, First_Mammography, LatestDate_Mammography, Number_Mammography, PreviousDate_Mammography, Diagnosis_Mammography, Date_Diagnosis_Mammography, AccessionNumber_Mammography, Lesion_Mammography, LesionLocation_Mammography, Shape_Mammography, Size_Mammography, Margin_Mammography, Density_Mammography, Calcification_Mammography, Calcification_Implication_Mammography, Calcification_Distribution_Mammography, Architecture_Mammography, Asymmetry_Mammography, IntraMammaryLN_Mammography, SkinLesion_Mammography, DilatedDuct_Mammography, Features_SkinRetraction_Mammography, Features_NippleRetraction_Mammography, Features_SkinThickening_Mammography, Features_TrabecularThickening_Mammography, Features_AxillaryLymphadenopathy_Mammography, SecondaryLesion_ContralateralBreast_Mammography, DistancefromSkin_Mammography, DistanceFromPectMaj_Mammography, BIRADS_Mammography, Tomosynthesis, Date_Tomosynthesis, Accession_Tomosynthesis, Lesion_Tomosynthesis, Size_Tomosynthesis, Distance_Tomosynthesis, Distance_PectMajor_Tomosynthesis, Diagnosis_Tomosynthesis, Block_SR_Number, Biopsy_Block_ID, No_of_blocks, Date_of_Biopsy, Lab_ID, Biopsy_Type, Tumour_biopsy_diagnosis, Tumour_biopsy_diagnosis_grade, Tumour_biopsy_ER, Tumour_biopsy_ER_Percent, Tumour_biopsy_PR, Tumour_biopsy_PR_Percent, Tumour_biopsy_HER2, Tumour_biopsy_HER2_Grade, Tumour_biopsy_FISH, Tumour_biopsy_Ki67_Percent, Lymph_Node_biopsy_FNAC, Lymph_Node_biopsy_location, Lymph_Node_biopsy_diagnosis, Surgical_Block_ID, Surgery_No_of_blocks, Block_Source, Tumor_block_ref, Nodes_block_ref, Ad_Normal_block_ref, Reduction_tissue_block_ref, Date_of_Surgery, Name_Surgeon, Hospital_ID, Lesion_Side, Type_surgery, Response_surgery, Tumour_size_Surgery_Block_Report, Grade_Surgery_Block_Report, Diagnosis_Surgery_Block_Report, DCIS_Percent_Surgery_Block_Report, DCIS_Invasion_Surgery_Block_Report, Perineural_Invasion_Surgery_Block_Report, Necrosis_Surgery_Block_Report, Lymphovascular_Invasion_Surgery_Block_Report, Margins_Surgery_Block_Report, Surgery_Block_Report, Sentinel_Node_Block_Report, Sentinel_Node_Number_Removed, Sentinel_Node_Number_Positive, Sentinel_Node_Block_Report_Number, Axillary_Node_Block_Report, Axillary_Node_Number_Removed, Axillary_Node_Number_Positive, Axillary_Node_Block_Report_Number, Apical_Node_Block_Report, Apical_Node_Number_Removed, Apical_Node_Number_Positive, Apical_Node_Block_Report_Number, Perinodal_Spread_Node_Block_Report, Supraclavicular_Involved_Node_Block_Report, Pathological_Staging_pT, Pathological_Staging_pN, Pathological_Staging_M, Pathological_Staging_P_Stage, Clinical_Staging)',)]
table = "Patient_Information_History"
sql = ('SELECT ' + ", ".join(pccm_names.pccm_names_info("bio_info")) + ' FROM ' + table + ' WHERE File_number = ?')
xx = cursor.execute(sql, file_number)
data_xx = xx.fetchall()
data_xx1 = list(data_xx[0])
data_xx2 = [pccm_names.pccm_names_info("bio_info")] + [data_xx1]
col_name = pccm_names.pccm_names_info("bio_info")
for i, row in enumerate (data_xx2):
    for j, value in enumerate(row):
        worksheet.write_row(i, 0, row)
workbook.close()